// stack-up.js
// Licensed under the MIT license - http://opensource.org/licenses/MIT
// Copyright (C) 2016 Andrew Prasetya
(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.StackUp=function(){function e(e){this.resizeHandler=t(this.resizeHandler,this),this.resizeComplete=t(this.resizeComplete,this);var i,o;for(i in e)o=e[i],this.config[i]=o}return e.prototype.containerElement=void 0,e.prototype.itemElements=void 0,e.prototype.containerHeight=0,e.prototype.containerWidth=0,e.prototype.items=[],e.prototype.numberOfColumns=0,e.prototype.boundary={height:0,width:0},e.prototype.config={containerSelector:void 0,itemsSelector:void 0,boundary:window,columnWidth:320,gutter:18,isFluid:!1,layout:"ordinal",numberOfColumns:3,resizeDebounceDelay:350,moveItem:function(t,e,i,o){return t.style.left=e+"px",t.style.top=i+"px",o()},scaleContainer:function(t,e,i,o){return t.style.height=i+"px",t.style.width=e+"px",o()}},e.prototype.initialize=function(){return window.addEventListener("resize",this.resizeHandler),this.boundaryUpdate(),this.updateSelectors(),this.populateItems(),this.updateNumberOfColumns(),this.applyLayout(),this.draw()},e.prototype.boundaryUpdate=function(){var t,e,i;return this.config.boundary!==window?(e=this.config.boundary.currentStyle||window.getComputedStyle(this.config.boundary),t=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),i=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),this.boundary.height=this.config.boundary.offsetHeight-i,this.boundary.width=this.config.boundary.offsetWidth-t):(this.boundary.height=window.innerHeight,this.boundary.width=window.innerWidth)},e.prototype.resizeDebounceTimeout=void 0,e.prototype.resizeDebounce=function(t,e){return clearTimeout(this.resizeDebounceTimeout),this.resizeDebounceTimeout=window.setTimeout(t,e)},e.prototype.resizeComplete=function(){return this.calculateNumberOfColumns()!==this.numberOfColumns&&this.config.isFluid?this.restack():void 0},e.prototype.resizeHandler=function(){return this.boundaryUpdate(),this.resizeDebounce(this.resizeComplete,this.config.resizeDebounceDelay)},e.prototype.updateSelectors=function(){return this.containerElement=document.querySelector(this.config.containerSelector),this.itemElements=document.querySelectorAll(this.config.containerSelector+" > "+this.config.itemsSelector)},e.prototype.appendItem=function(t){return t.style.width=this.config.columnWidth+"px",this.items.push([t,t.offsetHeight,0,0])},e.prototype.populateItems=function(){var t,e,i,o,n,r;for(this.items=[],n=this.itemElements,r=[],t=i=0,o=n.length;o>i;t=++i)e=n[t],r.push(this.appendItem(e));return r},e.prototype.calculateNumberOfColumns=function(){var t;return t=this.config.isFluid?Math.floor((this.boundary.width-this.config.gutter)/(this.config.columnWidth+this.config.gutter)):this.config.numberOfColumns,t>this.items.length&&(t=this.items.length),this.items.length&&0>=t&&(t=1),t},e.prototype.updateNumberOfColumns=function(){return this.numberOfColumns=this.calculateNumberOfColumns()},e.prototype.draw=function(){var t,e;return this.containerWidth=(this.config.columnWidth+this.config.gutter)*this.numberOfColumns,t=this.containerHeight+this.config.gutter,e=this.containerWidth+this.config.gutter,this.config.scaleContainer(this.containerElement,e,t,function(t){return function(){var e,i,o,n,r,s,u;for(e=function(){},s=t.items,u=[],i=n=0,r=s.length;r>n;i=++n)o=s[i],u.push(t.config.moveItem(o[0],o[2],o[3],e));return u}}(this))},e.prototype.layout={columnPointer:0,ordinal:{stack:[],setup:function(){var t;return this.stack=function(){var e,i,o,n;for(n=[],t=e=0,i=this.context.numberOfColumns-1;i>=0?i>=e:e>=i;t=i>=0?++e:--e)n.push((o=0,t=o[0],o));return n}.call(this)},plot:function(t){var e;return e=this.context,e.items[t][2]=e.config.gutter+(e.config.columnWidth+e.config.gutter)*e.layout.columnPointer,e.items[t][3]=e.config.gutter+this.stack[e.layout.columnPointer],this.stack[e.layout.columnPointer]+=e.items[t][1]+e.config.gutter,this.stack[e.layout.columnPointer]>e.containerHeight&&(e.containerHeight=this.stack[e.layout.columnPointer]),e.layout.columnPointer++,e.layout.columnPointer>=e.numberOfColumns?e.layout.columnPointer=0:void 0},loop:function(){var t,e,i,o;for(o=[],t=e=0,i=this.context.items.length-1;i>=0?i>=e:e>=i;t=i>=0?++e:--e)o.push(this.plot(t));return o}},optimized:{stack:[],setup:function(){var t;return this.stack=function(){var e,i,o,n;for(n=[],t=e=0,i=this.context.numberOfColumns-1;i>=0?i>=e:e>=i;t=i>=0?++e:--e)n.push((o=[t,0],t=o[0],o));return n}.call(this)},plot:function(t){var e;return e=this.context,e.items[t][2]=e.config.gutter+(e.config.columnWidth+e.config.gutter)*this.stack[0][0],e.items[t][3]=e.config.gutter+this.stack[0][1],this.stack[0][1]+=e.items[t][1]+e.config.gutter,this.stack[0][1]>e.containerHeight&&(e.containerHeight=this.stack[0][1]),this.stack.sort(function(t,e){return t[1]-e[1]}),e.layout.columnPointer++,e.layout.columnPointer>=e.numberOfColumns?e.layout.columnPointer=0:void 0},loop:function(){var t,e,i,o;for(o=[],t=e=0,i=this.context.items.length-1;i>=0?i>=e:e>=i;t=i>=0?++e:--e)o.push(this.plot(t));return o}}},e.prototype.applyLayout=function(){return this.layout[this.config.layout].context=this,this.layout[this.config.layout].setup(),this.items.length?this.layout[this.config.layout].loop():void 0},e.prototype.resetLayout=function(){return this.containerHeight=0,this.layout.columnPointer=0},e.prototype.reset=function(){this.containerWidth=0,this.containerHeight=0,this.items=[],this.updateSelectors(),this.populateItems(),this.resetLayout(),this.restack()},e.prototype.append=function(t,e){var i;return i=this.items.length,this.appendItem(t),this.calculateNumberOfColumns()===this.numberOfColumns?(this.layoutType[stackgrid.config.layout].plot(i),this.draw()):this.restack()},e.prototype.restack=function(){return this.updateNumberOfColumns(),this.resetLayout(),this.applyLayout(),this.draw()},e}()}).call(this);
